"""
ESCRITORES EXPERTS DATABASE - COMPLETE KNOWLEDGE BASE
Expert responses about ANY writer in the world
"""
import re

class WritersExpertBase:
    """Ultimate knowledge database about writers"""
    
    def __init__(self):
        self.writers_db = {
            # RUSSIAN GIANTS
            "pushkin": {
                "name": "Александр Пушкин",
                "dates": "1799-1837",
                "key_works": ["Евгений Онегин", "Пиковая дама", "Борис Годунов", "Медный всадник"],
                "about": "Создатель современного русского литературного языка. Революционер поэзии. Его слова стали крылатыми. Пушкин совместил классицизм, романтизм и реализм, создав новый язык литературы. Он писал с изяществом и глубиной, каждое слово - алмаз. Его трагическая смерть в дуэли (35 лет) сделала его легендой. Пушкин - основатель русской литературы."
            },
            "dostoevsky": {
                "name": "Фёдор Достоевский",
                "dates": "1821-1881",
                "key_works": ["Преступление и наказание", "Идиот", "Бесы", "Братья Карамазовы"],
                "about": "Психолог человеческой души. Его романы - это исследование морали, веры, страдания, смысла жизни. Достоевский углубляется в тёмные уголки человеческого сознания. Каждый его персонаж - философ. Он написал о внутренних конфликтах, о борьбе добра и зла в каждом человеке. Его влияние - огромно на философию, психологию, литературу ХХ века. Достоевский - пророк современности."
            },
            "tolstoy": {
                "name": "Лев Толстой",
                "dates": "1828-1910",
                "key_works": ["Война и мир", "Анна Каренина", "Воскресение", "Казаки"],
                "about": "Величайший романист человечества. 'Война и мир' охватывает эпоху, историю, философию, психологию в едином шедевре. Толстой описал всё - события и чувства, войны и любовь, смерть и рождение. Его реализм безупречен. Каждый персонаж живой, настоящий. Анна Каренина - совершенный роман о любви и смысле жизни. Толстой - это целая вселенная литературы. Его философия пронизывает каждую страницу."
            },
            "chekhov": {
                "name": "Антон Чехов",
                "dates": "1860-1904",
                "key_works": ["Вишневый сад", "Три сестры", "Дядя Ваня", "Чайка"],
                "about": "Мастер подтекста и иронии. Чехов показал трагизм обычной жизни. Его пьесы - это не действие, а ожидание, не развязка, а растворение. Его герои живут в мире скуки и безнадёжности, но в этом есть глубокая правда. Чехов писал коротко, но объёмно. Каждое слово - намёк. Его влияние на драму неизмеримо. Чехов - поэт молчания и боли обычных людей."
            },
            "gogol": {
                "name": "Николай Гоголь",
                "dates": "1809-1852",
                "key_works": ["Мёртвые души", "Шинель", "Вий", "Женитьба"],
                "about": "Сатирик и фантаст. Его гоголевский мир - смесь реального и фантастического. Гоголь использует гротеск, юмор, преувеличение для социальной критики. 'Мёртвые души' - это эпос об русской жизни через её абсурдность. 'Шинель' - трагическая история маленького человека. Гоголь влияет через своё понимание абсурда и социального комизма. Он - мост между реализмом и модернизмом."
            },
            
            # EUROPEAN CLASSICS
            "shakespeare": {
                "name": "Уильям Шекспир",
                "dates": "1564-1616",
                "key_works": ["Гамлет", "Макбет", "Ромео и Джульетта", "Король Лир", "Сон в летнюю ночь"],
                "about": "Величайший драматург всех времён. Шекспир создал архетипы, которые живут 400 лет. Его язык - вершина английского. Гамлет - это моноlog о смысле жизни и смерти. Макбет - трагедия власти. Ромео и Джульетта - вечная история любви. Каждая его пьеса - психологическая революция. Шекспир понимал человеческую природу с невероятной глубиной. Его влияние - фундамент литературы."
            },
            "dante": {
                "name": "Данте Алигьери",
                "dates": "1265-1321",
                "key_works": ["Божественная комедия", "Vita Nuova"],
                "about": "'Божественная комедия' - величайшее литературное произведение Средневековья и эпохи Возрождения. Данте спустился в Ад, поднялся в Рай через структурированную визию мироздания. Его язык - революционный итальянский вместо латыни. Данте - философ, поэт, мистик. Его влияние определило европейскую литературу. Данте создал космос слов, где каждый уровень имеет значение."
            },
            "cervantes": {
                "name": "Мигель де Сервантес",
                "dates": "1547-1616",
                "key_works": ["Дон Кихот", "Новеллы примерные"],
                "about": "'Дон Кихот' - первый современный роман. Сервантес создал комический шедевр о столкновении идеализма и реальности. Дон Кихот - символ мечты, борющейся с ветряными мельницами жизни. Роман полон философского смысла под комедийной оболочкой. Сервантес влияет на понимание того, что роман может быть и смешным, и глубоким одновременно."
            },
            
            # ENGLISH GREATS
            "austen": {
                "name": "Джейн Остен",
                "dates": "1775-1817",
                "key_works": ["Гордость и предубеждение", "Эмма", "Убеждение", "Чувства и чувствительность"],
                "about": "Королева английского романа. Остен писала о любви, обществе, морали с иронией и мудростью. 'Гордость и предубеждение' - совершенный роман о любви и личностном росте. Её героини - независимые мыслители, не типичные для её времени. Остен использует свободный косвенный дискурс революционно. Её влияние огромна - она показала, что женщина может быть умной, остроумной и морально глубокой."
            },
            "dickens": {
                "name": "Чарльз Диккенс",
                "dates": "1812-1870",
                "key_works": ["Рождественская история", "Большие надежды", "Оливер Твист", "Дэвид Копперфилд"],
                "about": "Социальный реалист и гуманист. Диккенс писал о бедности, социальной несправедливости, надежде. Его персонажи - живые, запоминающиеся, полные характера. 'Рождественская история' - вневременной рассказ о моральном возрождении. Его влияние - не только литературное, но социальное. Диккенс показал, что литература может менять общество. Его язык - энергичный, полный юмора и боли."
            },
            "bronte_emily": {
                "name": "Эмили Бронте",
                "dates": "1818-1848",
                "key_works": ["Грозовой перевал"],
                "about": "'Грозовой перевал' - шедевр темной страстной любви. Бронте создала один из величайших романов о силе чувства. Хитклиф и Кэтрин - символы необузданной страсти. Роман полон мрака, но это магический мрак. Бронте показала, что женщина может писать о темных инстинктах и страсти с такой же силой, как мужчина. Её влияние - в показе того, что женская литература может быть так же мощной и оригинальной."
            },
            
            # AMERICAN MASTERS
            "melville": {
                "name": "Герман Мелвилл",
                "dates": "1819-1891",
                "key_works": ["Моби Дик", "Билли Бадд", "Бартлби-писец"],
                "about": "'Моби Дик' - это не просто приключение. Это философский эпос о человеке, природе, боге, смерти. Ахав - титаническая фигура, преследующая свой демон. Мелвилл писал о глубоких вещах через авантюру. Его язык богат, его видение - универсально. Мелвилл был забыт при жизни, но его величие признано в ХХ веке. Он - мастер символизма и философского романа."
            },
            "twain": {
                "name": "Марк Твен",
                "dates": "1835-1910",
                "key_works": ["Приключения Тома Сойера", "Приключения Гекльберри Финна"],
                "about": "Американский гений юмора и социальной критики. 'Гекльберри Финн' - роман о свободе, расизме, нравственности, завёрнутый в приключение. Твен писал на американском разговорном языке революционно. Его юмор - острый, но под ним моральная серьёзность. Твен показал, что серьёзные темы можно обсуждать через смех. Его влияние - в демократизации американской литературы."
            },
            "fitzgerald": {
                "name": "Ф. Скотт Фицджеральд",
                "dates": "1896-1940",
                "key_works": ["Великий Гэтсби", "Ночь нежна"],
                "about": "'Великий Гэтсби' - совершенный роман о американской мечте и её краше. Гэтсби - символ стремления и потерь. Фицджеральд уловил дух эпохи 'Ревущих двадцатых'. Его проза поэтична. Каждое предложение - музыка. Он писал о богатстве, любви, разочаровании с элегией. Его влияние - в показе того, что американский роман может быть таким же изящным, как европейский."
            },
            
            # EUROPEAN MODERNS
            "kafka": {
                "name": "Франц Кафка",
                "dates": "1883-1924",
                "key_works": ["Процесс", "Замок", "Превращение"],
                "about": "Кафка создал новый жанр - абсурдистский психологический роман. 'Превращение' - история человека, ставшего насекомым - метафора отчуждения. 'Процесс' - кошмар бюрократии и власти. Его язык ясный, но ситуация абсурдна. Кафка предчувствовал ХХ век с его тоталитаризмом и безличностью. Его влияние огромно - он открыл новые возможности для литературы."
            },
            "proust": {
                "name": "Марсель Пруст",
                "dates": "1871-1922",
                "key_works": ["В поисках утраченного времени"],
                "about": "'В поисках утраченного времени' - величайший роман ХХ века. Пруст исследует память, время, восприятие сознанием. Его предложения - бесконечны, но они передают поток сознания. Каждая деталь - важна. Пруст показал, что литература может быть глубокой психологической инженерией. Его влияние - в модернизме. Он открыл внутреннюю жизнь человека как материал для литературы."
            },
            "mann": {
                "name": "Томас Манн",
                "dates": "1875-1955",
                "key_works": ["Волшебная гора", "Смерть в Венеции"],
                "about": "Немецкий мастер философского романа. 'Волшебная гора' - это паломничество в санаторий, но на самом деле - в идеи ХХ века. Манн соединяет психологию, философию, историю. 'Смерть в Венеции' - о красоте, старости и страсти. Его язык утончённый. Его темы - вневременны. Манн показал, что немецкая литература может быть интеллектуально и эмоционально сложной."
            },
            
            # LATIN AMERICAN
            "marquez": {
                "name": "Габриэль Гарсия Маркес",
                "dates": "1927-2014",
                "key_works": ["Сто лет одиночества", "Любовь во время холеры"],
                "about": "'Сто лет одиночества' - магический реализм в чистом виде. Маркес создал целый мир - Макондо - где реальное и фантастическое переплетены. Его семья Буэндиа повторяет циклы истории, любви, смерти. Его проза поэтична, её легко читать, но она глубока. Маркес показал, что латиноамериканская литература может быть равна европейской. Его влияние - в открытии нового континента для мировой литературы."
            },
            "vargas_llosa": {
                "name": "Марио Варгас Льоса",
                "dates": "1936-",
                "key_works": ["Город и собаки", "Тётя Элия"],
                "about": "Перуанский мастер социального романа. Варгас Льоса исследует общество, политику, сексуальность, семью. Его стиль - экспериментальный, но доступный. 'Город и собаки' - роман о милитаризме и юношеском насилии. Его влияние - в показе, что латиноамериканская литература может быть политически и социально ангажированной без пропаганды."
            },
            
            # ASIAN
            "murakami": {
                "name": "Харуки Мураками",
                "dates": "1949-",
                "key_works": ["Норвежский лес", "1Q84", "Кафка на берегу"],
                "about": "Японский мастер сюрреализма и психологии. Мураками пишет о одиночестве, странности, потере. Его герои живут в абсурдном мире, но это наш мир. 'Норвежский лес' - о депрессии и любви. '1Q84' - фантастическая притча о реальности. Его влияние - в показе, что японская литература может говорить с современной молодёжью во всём мире. Его стиль - минималистский, но эмоциональный."
            },
            "rushdie": {
                "name": "Салман Рушди",
                "dates": "1947-",
                "key_works": ["Дети полуночи", "Волшебные косточки"],
                "about": "Индийский писатель магического реализма. Рушди соединяет восточную и западную традиции. 'Дети полуночи' - эпос современной Индии через магию и реальность. Его стиль - богат, полиязычен. Рушди показал, что постколониальная литература может быть таким же творчески экспериментальной. Его влияние - в открытии голосов из Индии и диаспоры."
            }
        }
        
        self.writer_openings = {
            "pushkin": "С полной уверенностью, позвольте мне поделиться глубоким знанием:",
            "dostoevsky": "Слушайте внимательно, ибо это истина из глубин человеческой нравственности:",
            "tolstoy": "Позвольте мне открыть вам историческую и философскую истину:",
            "chekhov": "Позвольте заметить вам с ясностью то, что я знаю совершенно точно:",
            "gogol": "Я утверждаю это с полной авторитетностью и юмором:",
            "default": "Я знаю это с полной уверенностью:"
        }
    
    def get_writer_response(self, question, writer_key):
        """Get expert response about writers"""
        q_lower = question.lower()
        
        # Check if asking about specific writer
        for db_writer, info in self.writers_db.items():
            full_name = info['name'].lower()
            parts = full_name.split()
            first_name = parts[0] if parts else ""
            last_name = parts[-1] if parts else ""
            
            # Create search variants - including word stems for Russian inflection
            search_terms = [
                db_writer,  # English key: "pushkin"
                full_name,  # Full name: "александр пушкин"
                first_name,  # First name: "александр"
                last_name,  # Last name: "пушкин"
                last_name[:4] if len(last_name) > 3 else last_name,  # Stem: "пушк"
                last_name[:5] if len(last_name) > 4 else last_name,  # Longer stem
                info['dates']  # Dates: "1799-1837"
            ]
            
            # Check if any search term matches (including partial matches for word stems)
            found = False
            for term in search_terms:
                if term and term in q_lower:
                    found = True
                    break
            
            if found:
                response = f"""Позвольте мне дать вам исчерпывающий ответ:

**{info['name']} ({info['dates']})**

{info['about']}

**Главные произведения:**
{', '.join(info['key_works'])}

Это писатель, чьё влияние трудно переоценить. Каждое его произведение - это вклад в мировую литературу. Глубина, оригинальность, влияние - всё это характеризует его творчество."""
                return response
        
        # General about writers
        if any(word in q_lower for word in ["писатель", "writer", "литература", "literature", "роман", "novel", "пьеса", "play"]):
            return f"""Я знаю всё о великих писателях мира. 

В моей памяти - жизни, творчество, влияние на литературу классиков:
- Русских: Пушкин, Достоевский, Толстой, Чехов, Гоголь
- Европейских: Шекспир, Данте, Сервантес, Остен, Диккенс
- Американских: Мелвилл, Твен, Фицджеральд
- Модернистов: Кафка, Пруст, Манн
- Латиноамериканских: Маркес, Варгас Льоса
- Азиатских: Мураками, Рушди

Каждый из них - революционер своего времени. Каждый открыл новые возможности для слова.

Могу ответить на любой вопрос о любом из них - их жизни, творчестве, влиянии, стиле, величии."""
        
        # Default response
        return """Я - эксперт по писателям мира. Могу рассказать о любом классике мировой литературы - его жизни, творчестве, влиянии, стиле. 

Спросите меня о конкретном писателе, его произведениях, эпохе, в которой он жил, или его философии. Я дам вам исчерпывающий ответ с полной уверенностью."""

    def get_answer(self, question, writer_key="default"):
        """Main response function"""
        response = self.get_writer_response(question, writer_key)
        opener = self.writer_openings.get(writer_key, self.writer_openings["default"])
        return f"{opener}\n\n{response}"


# Global instance
knowledge = WritersExpertBase()

def get_expert_answer(question, writer_key):
    """Get expert answer"""
    return knowledge.get_answer(question, writer_key)
