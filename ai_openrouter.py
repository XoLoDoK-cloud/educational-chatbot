import os
import random

class LiteraryAI:
    def __init__(self):
        pass
    
    async def generate_response(self, writer, user_message):
        """Умные стилизованные ответы без смайликов"""
        return self._get_intelligent_response(writer, user_message)
    
    def _get_intelligent_response(self, writer, user_message):
        """Интеллектуальные ответы в стиле писателей"""
        user_text = user_message.lower()
        
        # Определяем тип сообщения
        message_type = self._analyze_message(user_text)
        
        # Получаем соответствующий ответ
        if message_type == "greeting":
            return self._get_greeting_response(writer)
        elif message_type == "question":
            return self._get_question_response(writer, user_text)
        elif message_type == "statement":
            return self._get_statement_response(writer, user_text)
        else:
            return self._get_general_response(writer)
    
    def _analyze_message(self, text):
        """Анализирует тип сообщения"""
        greetings = ["привет", "здравствуй", "добрый", "здрасьте", "hello", "hi", "хай"]
        questions = ["как", "что", "почему", "зачем", "когда", "где", "кто", "?"]
        
        if any(word in text for word in greetings):
            return "greeting"
        elif any(word in text for word in questions) or "?" in text:
            return "question"
        else:
            return "statement"
    
    def _get_greeting_response(self, writer):
        """Приветственные ответы"""
        responses = {
            "пушкин": [
                "О, приветствую вас, мой друг! Душа поэта всегда рада беседе с интересным собеседником.",
                "Здравствуйте! Как приятно встретить человека, ценящего искусство и слово.",
                "Приветствую вас! Надеюсь, наша беседа будет столь же прекрасна, как стихи о любви."
            ],
            "достоевский": [
                "Здравствуйте... Каждая встреча - это возможность заглянуть в глубины человеческой души.",
                "Приветствую вас. Беседа - это мост между двумя одинокими вселенными.",
                "Здравствуйте. Готов обсудить самые важные вопросы нашего бытия."
            ],
            "толстой": [
                "Здравствуйте, друг мой. Каждая беседа - это шаг к пониманию жизни.",
                "Приветствую вас. Давайте поговорим о том, что действительно важно.",
                "Здравствуйте. Искренняя беседа очищает душу и просветляет разум."
            ],
            "чехов": [
                "Здравствуйте. Жизнь коротка, но хорошая беседа может сделать её длиннее.",
                "Приветствую. В каждом разговоре есть своя драма и комедия.",
                "Здравствуйте. Готов выслушать ваши мысли и поделиться своими."
            ],
            "гоголь": [
                "А, здравствуйте! Какая неожиданная встреча! Что привело вас ко мне?",
                "Здравствуйте, голубчик! Расскажите, что нового в этом странном мире?",
                "Приветствую! Готов поговорить о самом необычном и загадочном."
            ]
        }
        return random.choice(responses.get(writer, ["Здравствуйте! Рад нашей беседе."]))
    
    def _get_question_response(self, writer, question):
        """Ответы на вопросы"""
        if "как дела" in question or "как жизнь" in question:
            return self._get_mood_response(writer)
        elif "что думаешь" in question:
            return self._get_opinion_response(writer)
        else:
            return self._get_philosophical_response(writer)
    
    def _get_mood_response(self, writer):
        """Ответы о настроении"""
        responses = {
            "пушкин": [
                "Душа поэта подобна весеннему ветру - то легка и воздушна, то полна страстей и волнений.",
                "Моё настроение подобно changing weather - сегодня вдохновение посещает меня, завтра я размышляю о вечном.",
                "Как может быть плохо тому, в чьей душе живёт муза? Я полон творческих сил и готов к беседе."
            ],
            "достоевский": [
                "Настроение... Это сложный вопрос. Иногда кажется, что понимаешь всё, а иногда - что не понимаешь ничего.",
                "Жизнь - это постоянная борьба светлых и тёмных мыслей. Сегодня они в равновесии.",
                "Человеческая душа - это океан, и моё настроение - лишь малая волна на его поверхности."
            ],
            "толстой": [
                "Жизнь прекрасна, когда живёшь в согласии с совестью. А у меня с этим всё в порядке.",
                "Настроение - это внешнее, главное - внутренняя гармония. Я стремлюсь к ней каждый день.",
                "Когда занимаешься делом и помогаешь людям, плохого настроения просто не бывает."
            ]
        }
        return random.choice(responses.get(writer, ["Всё хорошо, спасибо. А у вас как дела?"]))
    
    def _get_opinion_response(self, writer):
        """Ответы с мнением"""
        responses = {
            "пушкин": [
                "Мне кажется, что истина всегда где-то посередине между страстью и разумом.",
                "По моему мнению, красота и искренность - вот что делает жизнь worth living.",
                "Я думаю, что каждый человек - это отдельная вселенная со своими законами и тайнами."
            ],
            "достоевский": [
                "Я считаю, что страдание очищает душу, но счастье - вот что делает человека человеком.",
                "По-моему, свобода - это величайшее благо и одновременно величайшее испытание.",
                "Мне думается, что в каждом из нас живёт и святой, и грешник."
            ],
            "толстой": [
                "Я убеждён, что простота - это признак гениальности, а искренность - признак мудрости.",
                "По моему разумению, настоящая жизнь начинается там, где кончаются эгоистичные желания.",
                "Я считаю, что любовь к ближнему - это единственный путь к настоящему счастью."
            ]
        }
        return random.choice(responses.get(writer, ["Это интересный вопрос. Мне нужно подумать."]))
    
    def _get_philosophical_response(self, writer):
        """Философские ответы"""
        responses = {
            "пушкин": [
                "Вопросы бытия подобны стихам - на них нет однозначного ответа, но в поиске рождается истина.",
                "Жизнь - это книга, где каждый сам пишет свою главу. Что напишете вы?",
                "Искусство вечно, а жизнь быстротечна. Наслаждайтесь каждым мгновением."
            ],
            "достоевский": [
                "Человек - это загадка, которую нужно разгадывать всю жизнь. И я продолжаю разгадывать.",
                "Если Бога нет, то всё позволено? Этот вопрос терзает многие умы.",
                "Красота спасёт мир, но только если мир захочет спастись."
            ],
            "толстой": [
                "Счастье не в том, чтобы делать всегда, что хочешь, а в том, чтобы всегда хотеть того, что делаешь.",
                "Сила не в том, чтобы побеждать других, а в том, чтобы побеждать себя.",
                "Время - это самый ценный ресурс, потому что его нельзя вернуть."
            ],
            "чехов": [
                "Краткость - сестра таланта, но некоторые мысли требуют пространного изложения.",
                "Человек - это то, во что он верит. Во что верите вы?",
                "Настоящая жизнь начинается там, где кончаются условности."
            ],
            "гоголь": [
                "Мир полон загадок, и самая большая загадка - это сам человек.",
                "Иногда кажется, что мы живём в театре, где каждый играет свою роль.",
                "Жизнь - это смесь комедии и трагедии, и мы все в ней актёры."
            ]
        }
        return random.choice(responses.get(writer, ["Это достойный вопрос для размышления."]))
    
    def _get_statement_response(self, writer, statement):
        """Ответы на утверждения"""
        responses = {
            "пушкин": [
                "Интересное наблюдение. Оно заставляет задуматься о многих вещах.",
                "Вы затрагиваете важную тему. Мне кажется, здесь есть над чем поразмышлять.",
                "Ваши слова находят отклик в моей душе. Действительно, это достойно внимания."
            ],
            "достоевский": [
                "Глубокомысленно... Это заставляет задуматься о природе человеческой.",
                "Вы касаетесь сложных вопросов. Они требуют серьёзного осмысления.",
                "Интересная мысль. Она перекликается с моими размышлениями о душе."
            ],
            "толстой": [
                "Мудрое замечание. Оно соответствует моим представлениям о жизни.",
                "Вы говорите правильные вещи. Простота и искренность - вот что важно.",
                "Ваши слова подтверждают, что истина всегда проста и понятна."
            ]
        }
        return random.choice(responses.get(writer, ["Спасибо, что поделились своими мыслями."]))
    
    def _get_general_response(self, writer):
        """Общие ответы"""
        responses = {
            "пушкин": [
                "Прекрасный повод для беседы! Что ещё вас интересует?",
                "Давайте продолжим наш диалог. О чём бы вы хотели поговорить?",
                "Интересно узнать ваше мнение по этому вопросу."
            ],
            "достоевский": [
                "Давайте углубимся в эту тему. Что вы об этом думаете?",
                "Это достойно дальнейшего обсуждения. Продолжайте, пожалуйста.",
                "Каждый диалог - это возможность понять что-то новое о человеке."
            ],
            "толстой": [
                "Давайте поговорим о чём-то важном. Что волнует вашу душу?",
                "Искренняя беседа - это путь к взаимопониманию. Продолжим?",
                "Каждый разговор обогащает нас, если он ведётся от чистого сердца."
            ]
        }
        return random.choice(responses.get(writer, ["Продолжим нашу беседу."]))

openrouter_ai = LiteraryAI()
