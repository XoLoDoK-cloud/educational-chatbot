"""
LITERARY GENIUS DATABASE - COMPREHENSIVE WRITERS KNOWLEDGE
Expert responses about writers, works, and literary movements worldwide
"""
import re

class WritersExpertBase:
    """Ultimate knowledge database about writers"""
    
    def __init__(self):
        self.writers_db = {
            # RUSSIAN GIANTS
            "pushkin": {
                "name": "Александр Пушкин",
                "dates": "1799-1837",
                "key_works": ["Евгений Онегин", "Пиковая дама", "Борис Годунов", "Медный всадник"],
                "works_with_dates": {
                    "Евгений Онегин": "1833",
                    "Пиковая дама": "1834",
                    "Борис Годунов": "1825",
                    "Медный всадник": "1833"
                },
                "about": "Создатель современного русского литературного языка. Революционер поэзии. Его слова стали крылатыми. Пушкин совместил классицизм, романтизм и реализм, создав новый язык литературы. Он писал с изяществом и глубиной, каждое слово - алмаз. Его трагическая смерть в дуэли (35 лет) сделала его легендой. Пушкин - основатель русской литературы."
            },
            "dostoevsky": {
                "name": "Фёдор Достоевский",
                "dates": "1821-1881",
                "key_works": ["Преступление и наказание", "Идиот", "Бесы", "Братья Карамазовы"],
                "works_with_dates": {
                    "Преступление и наказание": "1866",
                    "Идиот": "1869",
                    "Бесы": "1872",
                    "Братья Карамазовы": "1880"
                },
                "about": "Психолог человеческой души. Его романы - это исследование морали, веры, страдания, смысла жизни. Достоевский углубляется в тёмные уголки человеческого сознания. Каждый его персонаж - философ. Он написал о внутренних конфликтах, о борьбе добра и зла в каждом человеке. Его влияние - огромно на философию, психологию, литературу ХХ века. Достоевский - пророк современности."
            },
            "tolstoy": {
                "name": "Лев Толстой",
                "dates": "1828-1910",
                "key_works": ["Война и мир", "Анна Каренина", "Воскресение", "Казаки"],
                "works_with_dates": {
                    "Война и мир": "1869",
                    "Анна Каренина": "1877",
                    "Воскресение": "1899",
                    "Казаки": "1863"
                },
                "about": "Величайший романист человечества. 'Война и мир' охватывает эпоху, историю, философию, психологию в едином шедевре. Толстой описал всё - события и чувства, войны и любовь, смерть и рождение. Его реализм безупречен. Каждый персонаж живой, настоящий. Анна Каренина - совершенный роман о любви и смысле жизни. Толстой - это целая вселенная литературы. Его философия пронизывает каждую страницу."
            },
            "chekhov": {
                "name": "Антон Чехов",
                "dates": "1860-1904",
                "key_works": ["Вишневый сад", "Три сестры", "Дядя Ваня", "Чайка"],
                "works_with_dates": {
                    "Вишневый сад": "1904",
                    "Три сестры": "1901",
                    "Дядя Ваня": "1897",
                    "Чайка": "1896"
                },
                "about": "Мастер подтекста и иронии. Чехов показал трагизм обычной жизни. Его пьесы - это не действие, а ожидание, не развязка, а растворение. Его герои живут в мире скуки и безнадёжности, но в этом есть глубокая правда. Чехов писал коротко, но объёмно. Каждое слово - намёк. Его влияние на драму неизмеримо. Чехов - поэт молчания и боли обычных людей."
            },
            "gogol": {
                "name": "Николай Гоголь",
                "dates": "1809-1852",
                "key_works": ["Мёртвые души", "Шинель", "Вий", "Женитьба"],
                "works_with_dates": {
                    "Мёртвые души": "1842",
                    "Шинель": "1843",
                    "Вий": "1835",
                    "Женитьба": "1842"
                },
                "about": "Сатирик и фантаст. Его гоголевский мир - смесь реального и фантастического. Гоголь использует гротеск, юмор, преувеличение для социальной критики. 'Мёртвые души' - это эпос об русской жизни через её абсурдность. 'Шинель' - трагическая история маленького человека. Гоголь влияет через своё понимание абсурда и социального комизма. Он - мост между реализмом и модернизмом."
            },
            "fonvizin": {
                "name": "Денис Фонвизин",
                "dates": "1744/45-1792",
                "key_works": ["Недоросль", "Бригадир", "Письма из Франции"],
                "works_with_dates": {
                    "Недоросль": "1782",
                    "Бригадир": "1769",
                    "Письма из Франции": "1784"
                },
                "about": "Классик русского театра XVIII века. Драматург-просветитель, создатель комедии характеров. 'Недоросль' - шедевр социальной критики, высмеивающий невежество провинциального дворянства. Фонвизин писал обострённо, остроумно, с моральной целью. Его язык живой, разговорный, полный метких черт. Фонвизин - основатель национальной драматургии, мост между классицизмом и реализмом. Его влияние на развитие русского театра и языка - фундаментально."
            },
            
            # EUROPEAN CLASSICS
            "shakespeare": {
                "name": "Уильям Шекспир",
                "dates": "1564-1616",
                "key_works": ["Гамлет", "Макбет", "Ромео и Джульетта", "Король Лир", "Сон в летнюю ночь"],
                "works_with_dates": {
                    "Гамлет": "1601",
                    "Макбет": "1606",
                    "Ромео и Джульетта": "1595",
                    "Король Лир": "1606",
                    "Сон в летнюю ночь": "1595"
                },
                "about": "Величайший драматург всех времён. Шекспир создал архетипы, которые живут 400 лет. Его язык - вершина английского. Гамлет - это монолог о смысле жизни и смерти. Макбет - трагедия власти. Ромео и Джульетта - вечная история любви. Каждая его пьеса - психологическая революция. Шекспир понимал человеческую природу с невероятной глубиной. Его влияние - фундамент литературы."
            },
            "dante": {
                "name": "Данте Алигьери",
                "dates": "1265-1321",
                "key_works": ["Божественная комедия", "Vita Nuova"],
                "works_with_dates": {
                    "Божественная комедия": "1320",
                    "Vita Nuova": "1292"
                },
                "about": "'Божественная комедия' - величайшее литературное произведение Средневековья и эпохи Возрождения. Данте спустился в Ад, поднялся в Рай через структурированную визию мироздания. Его язык - революционный итальянский вместо латыни. Данте - философ, поэт, мистик. Его влияние определило европейскую литературу. Данте создал космос слов, где каждый уровень имеет значение."
            },
            "cervantes": {
                "name": "Мигель де Сервантес",
                "dates": "1547-1616",
                "key_works": ["Дон Кихот", "Новеллы примерные"],
                "works_with_dates": {
                    "Дон Кихот": "1605",
                    "Новеллы примерные": "1613"
                },
                "about": "'Дон Кихот' - первый современный роман. Сервантес создал комический шедевр о столкновении идеализма и реальности. Дон Кихот - символ мечты, борющейся с ветряными мельницами жизни. Роман полон философского смысла под комедийной оболочкой. Сервантес влияет на понимание того, что роман может быть и смешным, и глубоким одновременно."
            },
            
            # ENGLISH GREATS
            "austen": {
                "name": "Джейн Остен",
                "dates": "1775-1817",
                "key_works": ["Гордость и предубеждение", "Эмма", "Убеждение", "Чувства и чувствительность"],
                "works_with_dates": {
                    "Гордость и предубеждение": "1813",
                    "Эмма": "1815",
                    "Убеждение": "1817",
                    "Чувства и чувствительность": "1811"
                },
                "about": "Королева английского романа. Остен писала о любви, обществе, морали с иронией и мудростью. 'Гордость и предубеждение' - совершенный роман о любви и личностном росте. Её героини - независимые мыслители, не типичные для её времени. Остен использует свободный косвенный дискурс революционно. Её влияние огромна - она показала, что женщина может быть умной, остроумной и морально глубокой."
            },
            "dickens": {
                "name": "Чарльз Диккенс",
                "dates": "1812-1870",
                "key_works": ["Рождественская история", "Большие надежды", "Оливер Твист", "Дэвид Копперфилд"],
                "works_with_dates": {
                    "Рождественская история": "1843",
                    "Большие надежды": "1861",
                    "Оливер Твист": "1838",
                    "Дэвид Копперфилд": "1850"
                },
                "about": "Социальный реалист и гуманист. Диккенс писал о бедности, социальной несправедливости, надежде. Его персонажи - живые, запоминающиеся, полные характера. 'Рождественская история' - вневременной рассказ о моральном возрождении. Его влияние - не только литературное, но социальное. Диккенс показал, что литература может менять общество. Его язык - энергичный, полный юмора и боли."
            },
            "bronte_emily": {
                "name": "Эмили Бронте",
                "dates": "1818-1848",
                "key_works": ["Грозовой перевал"],
                "works_with_dates": {
                    "Грозовой перевал": "1847"
                },
                "about": "'Грозовой перевал' - шедевр темной страстной любви. Бронте создала один из величайших романов о силе чувства. Хитклиф и Кэтрин - символы необузданной страсти. Роман полон мрака, но это магический мрак. Бронте показала, что женщина может писать о темных инстинктах и страсти с такой же силой, как мужчина. Её влияние - в показе того, что женская литература может быть так же мощной и оригинальной."
            },
            
            # AMERICAN MASTERS
            "melville": {
                "name": "Герман Мелвилл",
                "dates": "1819-1891",
                "key_works": ["Моби Дик", "Билли Бадд", "Бартлби-писец"],
                "works_with_dates": {
                    "Моби Дик": "1851",
                    "Билли Бадд": "1891",
                    "Бартлби-писец": "1853"
                },
                "about": "'Моби Дик' - это не просто приключение. Это философский эпос о человеке, природе, боге, смерти. Ахав - титаническая фигура, преследующая свой демон. Мелвилл писал о глубоких вещах через авантюру. Его язык богат, его видение - универсально. Мелвилл был забыт при жизни, но его величие признано в ХХ веке. Он - мастер символизма и философского романа."
            },
            "twain": {
                "name": "Марк Твен",
                "dates": "1835-1910",
                "key_works": ["Приключения Тома Сойера", "Приключения Гекльберри Финна"],
                "works_with_dates": {
                    "Приключения Тома Сойера": "1876",
                    "Приключения Гекльберри Финна": "1884"
                },
                "about": "Американский гений юмора и социальной критики. 'Гекльберри Финн' - роман о свободе, расизме, нравственности, завёрнутый в приключение. Твен писал на американском разговорном языке революционно. Его юмор - острый, но под ним моральная серьёзность. Твен показал, что серьёзные темы можно обсуждать через смех. Его влияние - в демократизации американской литературы."
            },
            "fitzgerald": {
                "name": "Ф. Скотт Фицджеральд",
                "dates": "1896-1940",
                "key_works": ["Великий Гэтсби", "Ночь нежна"],
                "works_with_dates": {
                    "Великий Гэтсби": "1925",
                    "Ночь нежна": "1934"
                },
                "about": "'Великий Гэтсби' - совершенный роман о американской мечте и её краше. Гэтсби - символ стремления и потерь. Фицджеральд уловил дух эпохи 'Ревущих двадцатых'. Его проза поэтична. Каждое предложение - музыка. Он писал о богатстве, любви, разочаровании с элегией. Его влияние - в показе того, что американский роман может быть таким же изящным, как европейский."
            },
            
            # EUROPEAN MODERNS
            "kafka": {
                "name": "Франц Кафка",
                "dates": "1883-1924",
                "key_works": ["Процесс", "Замок", "Превращение"],
                "works_with_dates": {
                    "Процесс": "1925",
                    "Замок": "1926",
                    "Превращение": "1915"
                },
                "about": "Кафка создал новый жанр - абсурдистский психологический роман. 'Превращение' - история человека, ставшего насекомым - метафора отчуждения. 'Процесс' - кошмар бюрократии и власти. Его язык ясный, но ситуация абсурдна. Кафка предчувствовал ХХ век с его тоталитаризмом и безличностью. Его влияние огромно - он открыл новые возможности для литературы."
            },
            "proust": {
                "name": "Марсель Пруст",
                "dates": "1871-1922",
                "key_works": ["В поисках утраченного времени"],
                "works_with_dates": {
                    "В поисках утраченного времени": "1927"
                },
                "about": "'В поисках утраченного времени' - величайший роман ХХ века. Пруст исследует память, время, восприятие сознанием. Его предложения - бесконечны, но они передают поток сознания. Каждая деталь - важна. Пруст показал, что литература может быть глубокой психологической инженерией. Его влияние - в модернизме. Он открыл внутреннюю жизнь человека как материал для литературы."
            },
            "mann": {
                "name": "Томас Манн",
                "dates": "1875-1955",
                "key_works": ["Волшебная гора", "Смерть в Венеции"],
                "works_with_dates": {
                    "Волшебная гора": "1924",
                    "Смерть в Венеции": "1912"
                },
                "about": "Немецкий мастер философского романа. 'Волшебная гора' - это паломничество в санаторий, но на самом деле - в идеи ХХ века. Манн соединяет психологию, философию, историю. 'Смерть в Венеции' - о красоте, старости и страсти. Его язык утончённый. Его темы - вневременны. Манн показал, что немецкая литература может быть интеллектуально и эмоционально сложной."
            },
            
            # LATIN AMERICAN
            "marquez": {
                "name": "Габриэль Гарсия Маркес",
                "dates": "1927-2014",
                "key_works": ["Сто лет одиночества", "Любовь во время холеры"],
                "works_with_dates": {
                    "Сто лет одиночества": "1967",
                    "Любовь во время холеры": "1985"
                },
                "about": "'Сто лет одиночества' - магический реализм в чистом виде. Маркес создал целый мир - Макондо - где реальное и фантастическое переплетены. Его семья Буэндиа повторяет циклы истории, любви, смерти. Его проза поэтична, её легко читать, но она глубока. Маркес показал, что латиноамериканская литература может быть равна европейской. Его влияние - в открытии нового континента для мировой литературы."
            },
            "vargas_llosa": {
                "name": "Марио Варгас Льоса",
                "dates": "1936-",
                "key_works": ["Город и собаки", "Тётя Элия"],
                "works_with_dates": {
                    "Город и собаки": "1963",
                    "Тётя Элия": "1977"
                },
                "about": "Перуанский мастер социального романа. Варгас Льоса исследует общество, политику, сексуальность, семью. Его стиль - экспериментальный, но доступный. 'Город и собаки' - роман о милитаризме и юношеском насилии. Его влияние - в показе, что латиноамериканская литература может быть политически и социально ангажированной без пропаганды."
            },
            
            # ASIAN
            "murakami": {
                "name": "Харуки Мураками",
                "dates": "1949-",
                "key_works": ["Норвежский лес", "1Q84", "Кафка на берегу"],
                "works_with_dates": {
                    "Норвежский лес": "1987",
                    "1Q84": "2009",
                    "Кафка на берегу": "2002"
                },
                "about": "Японский мастер сюрреализма и психологии. Мураками пишет о одиночестве, странности, потере. Его герои живут в абсурдном мире, но это наш мир. 'Норвежский лес' - о депрессии и любви. '1Q84' - фантастическая притча о реальности. Его влияние - в показе, что японская литература может говорить с современной молодёжью во всём мире. Его стиль - минималистский, но эмоциональный."
            },
            "rushdie": {
                "name": "Салман Рушди",
                "dates": "1947-",
                "key_works": ["Дети полуночи", "Волшебные косточки"],
                "works_with_dates": {
                    "Дети полуночи": "1981",
                    "Волшебные косточки": "1988"
                },
                "about": "Индийский писатель магического реализма. Рушди соединяет восточную и западную традиции. 'Дети полуночи' - эпос современной Индии через магию и реальность. Его стиль - богат, полиязычен. Рушди показал, что постколониальная литература может быть таким же творчески экспериментальной. Его влияние - в открытии голосов из Индии и диаспоры."
            },
            
            # ADDITIONAL EUROPEAN & CLASSICAL
            "cervantes_miguel": {
                "name": "Мигель де Сервантес",
                "dates": "1547-1616",
                "key_works": ["Дон Кихот", "Новеллы примерные"],
                "works_with_dates": {
                    "Дон Кихот": "1605",
                    "Новеллы примерные": "1613"
                },
                "about": "Испанский писатель, создатель первого современного романа. Его произведение 'Дон Кихот' - шедевр мировой литературы, сочетающий комедию и философию. Сервантес писал о столкновении идеализма и реальности с глубокой мудростью и юмором."
            },
            "cervantes_lope": {
                "name": "Лопе де Вега",
                "dates": "1562-1635",
                "key_works": ["Фуэнте Овехуна", "Собака на сене"],
                "works_with_dates": {
                    "Фуэнте Овехуна": "1614",
                    "Собака на сене": "1613"
                },
                "about": "Испанский драматург и поэт, один из самых плодовитых авторов в истории литературы. Его пьесы отличаются живостью, народностью и мастерством диалога. Вега - создатель испанского национального театра."
            },
            "montaigne": {
                "name": "Мишель Монтень",
                "dates": "1533-1592",
                "key_works": ["Опыты"],
                "works_with_dates": {
                    "Опыты": "1580"
                },
                "about": "Французский философ и писатель. Его 'Опыты' - революционный жанр личных размышлений. Монтень исследует человеческую природу, мораль и знание с скептицизмом и глубиной. Его влияние на западную философию неоценимо."
            },
            "balzac": {
                "name": "Оноре де Бальзак",
                "dates": "1799-1850",
                "key_works": ["Человеческая комедия", "Отец Горио", "Евгения Гранде"],
                "works_with_dates": {
                    "Человеческая комедия": "1830",
                    "Отец Горио": "1835",
                    "Евгения Гранде": "1833"
                },
                "about": "Французский реалист-революционер. Его цикл 'Человеческая комедия' - грандиозная панорама французского общества. Бальзак создал огромный мир персонажей, связанных сложными отношениями. Его влияние на развитие романа - фундаментально."
            },
            "flaubert": {
                "name": "Гюстав Флобер",
                "dates": "1821-1880",
                "key_works": ["Госпожа Бовари", "Саламбо", "Простая история"],
                "works_with_dates": {
                    "Госпожа Бовари": "1857",
                    "Саламбо": "1862",
                    "Простая история": "1874"
                },
                "about": "Французский писатель, мастер реализма и стилиста. 'Госпожа Бовари' - шедевр психологического романа. Флобер известен своим стремлением к совершенству стиля и глубокому анализу человеческих эмоций."
            },
            "hugo": {
                "name": "Виктор Гюго",
                "dates": "1802-1885",
                "key_works": ["Отверженные", "Собор Парижской Богоматери", "Человек, который смеётся"],
                "works_with_dates": {
                    "Отверженные": "1862",
                    "Собор Парижской Богоматери": "1831",
                    "Человек, который смеётся": "1869"
                },
                "about": "Французский писатель, поэт, драматург и политик. Его произведения - эпохальные вершины литературы. 'Отверженные' - роман о справедливости и милосердии, а 'Собор' - поэтическая история средневекового Парижа."
            },
            "dumas_elder": {
                "name": "Александр Дюма (старший)",
                "dates": "1802-1870",
                "key_works": ["Три мушкетёра", "Граф Монте-Кристо", "Королева Марго"],
                "works_with_dates": {
                    "Три мушкетёра": "1844",
                    "Граф Монте-Кристо": "1844",
                    "Королева Марго": "1845"
                },
                "about": "Французский писатель-романтик, мастер приключенческого романа. Его произведения полны действия, интриги и благородных идеалов. Дюма - создатель вечных образов Д'Артаньяна и Монте-Кристо."
            },
            "george_sand": {
                "name": "Жорж Санд",
                "dates": "1804-1876",
                "key_works": ["Консуэло", "Графиня де Рудольштадт", "Лелиа"],
                "works_with_dates": {
                    "Консуэло": "1842",
                    "Графиня де Рудольштадт": "1843",
                    "Лелиа": "1833"
                },
                "about": "Французская писательница-романтик. Санд известна своей борьбой за права женщин и социальную справедливость. Её романы - выражение гуманистических идеалов и страсти к красоте."
            },
            
            # AMERICAN CLASSICS
            "hawthorne": {
                "name": "Натаниель Готорн",
                "dates": "1804-1864",
                "key_works": ["Алая буква", "Дом семи щипцов"],
                "works_with_dates": {
                    "Алая буква": "1850",
                    "Дом семи щипцов": "1851"
                },
                "about": "Американский писатель, пионер психологического романа в Америке. Его произведения исследуют грех, вину и моральный конфликт. Готорн создал символический мир, где внешние события отражают внутренние драмы."
            },
            "poe": {
                "name": "Эдгар Аллан По",
                "dates": "1809-1849",
                "key_works": ["Ворон", "Падение дома Ашеров", "Убийство на Морг-стрит"],
                "works_with_dates": {
                    "Ворон": "1845",
                    "Падение дома Ашеров": "1839",
                    "Убийство на Морг-стрит": "1841"
                },
                "about": "Американский поэт и писатель, создатель детективного жанра. По - мастер готики и психологического ужаса. Его произведения исследуют мрак человеческой души. Его влияние на литературу неоценимо - он открыл новые возможности для прозы."
            },
            "thoreau": {
                "name": "Генри Дэвид Торо",
                "dates": "1817-1862",
                "key_works": ["Уолден", "О гражданском неповиновении"],
                "works_with_dates": {
                    "Уолден": "1854",
                    "О гражданском неповиновении": "1849"
                },
                "about": "Американский философ, натуралист и писатель. Торо выступал против общественного конформизма и за близость к природе. Его 'Уолден' - документ о жизни в гармонии с природой."
            },
            
            # EUROPEAN ROMANTICS & REALISTS
            "bronte_charlotte": {
                "name": "Шарлотта Бронте",
                "dates": "1816-1855",
                "key_works": ["Джейн Эйр"],
                "works_with_dates": {
                    "Джейн Эйр": "1847"
                },
                "about": "'Джейн Эйр' - революционный роман о независимой женщине, борющейся за равенство и любовь. Бронте создала персонажа, который не подчиняется ожиданиям общества. Роман полон страсти, морали и психологической глубины."
            },
            "stendhal": {
                "name": "Стендаль",
                "dates": "1783-1842",
                "key_works": ["Красное и чёрное", "Пармская обитель"],
                "works_with_dates": {
                    "Красное и чёрное": "1830",
                    "Пармская обитель": "1839"
                },
                "about": "Французский писатель, предшественник реализма. 'Красное и чёрное' - роман о амбициях молодого человека в послереволюционной Франции. Стендаль исследует психологию персонажей с новой глубиной."
            },
            "dumas_junior": {
                "name": "Александр Дюма (младший)",
                "dates": "1824-1895",
                "key_works": ["Дама с камелиями"],
                "works_with_dates": {
                    "Дама с камелиями": "1848"
                },
                "about": "'Дама с камелиями' - трагический роман о любви и жертве. Дюма создал легенду о куртизанке, способной на чистую любовь. Произведение вдохновило оперу и множество адаптаций."
            },
            
            # MORE MODERNS
            "joyce": {
                "name": "Джеймс Джойс",
                "dates": "1882-1941",
                "key_works": ["Улисс", "Портрет художника в юности"],
                "works_with_dates": {
                    "Улисс": "1922",
                    "Портрет художника в юности": "1916"
                },
                "about": "Ирландский писатель, революционер литературной формы. 'Улисс' - шедевр модернизма, использующий поток сознания. Джойс переосмыслил 'Одиссею' в Дублине одного дня."
            },
            "lawrence": {
                "name": "Дэвид Герберт Лоуренс",
                "dates": "1885-1930",
                "key_works": ["Сыновья и любовники", "Дама в белом"],
                "works_with_dates": {
                    "Сыновья и любовники": "1913",
                    "Дама в белом": "1920"
                },
                "about": "Британский писатель, исследующий сексуальность, класс и природу. Лоуренс писал о конфликте между инстинктом и обществом. Его произведения вызывали скандалы, но его влияние неоценимо."
            },
            "woolf": {
                "name": "Вирджиния Вулф",
                "dates": "1882-1941",
                "key_works": ["Миссис Дэллоуэй", "На маяк", "Волны"],
                "works_with_dates": {
                    "Миссис Дэллоуэй": "1925",
                    "На маяк": "1927",
                    "Волны": "1931"
                },
                "about": "Британская писательница, пионер модернизма. Вулф использовала поток сознания для исследования внутреннего опыта. Её произведения - поэтические исследования времени, памяти и женского опыта."
            },
            "hesse": {
                "name": "Герман Гессе",
                "dates": "1877-1962",
                "key_works": ["Степной волк", "Сиддхартха"],
                "works_with_dates": {
                    "Степной волк": "1927",
                    "Сиддхартха": "1922"
                },
                "about": "Немецкий писатель, философ и поэт. Гессе исследовал духовные поиски, конфликт личности и общества. 'Сиддхартха' - философский роман о пути к просветлению. Его влияние на контркультуру ХХ века огромно."
            },
            
            # MORE RUSSIAN WRITERS
            "lermontov": {
                "name": "Михаил Лермонтов",
                "dates": "1814-1841",
                "key_works": ["Герой нашего времени", "Демон"],
                "works_with_dates": {
                    "Герой нашего времени": "1840",
                    "Демон": "1841"
                },
                "about": "Русский поэт и писатель-романтик. 'Герой нашего времени' - первый психологический роман в русской литературе. Лермонтов изучал противоречивую природу человека."
            },
            "turgenev": {
                "name": "Иван Тургенев",
                "dates": "1818-1883",
                "key_works": ["Отцы и дети", "Дворянское гнездо"],
                "works_with_dates": {
                    "Отцы и дети": "1862",
                    "Дворянское гнездо": "1859"
                },
                "about": "Русский писатель, мастер реализма. 'Отцы и дети' - роман о конфликте поколений и идеологии. Тургенев писал с лиризмом и психологической проницательностью."
            },
            "goncharov": {
                "name": "Иван Гончаров",
                "dates": "1812-1891",
                "key_works": ["Обломов"],
                "works_with_dates": {
                    "Обломов": "1859"
                },
                "about": "'Обломов' - шедевр о русской апатии и мечтаниях. Гончаров создал типический образ русского барина. Роман - как медитация о времени, судьбе и смысле жизни."
            },
            "saltykov_shchedrin": {
                "name": "Михаил Салтыков-Щедрин",
                "dates": "1826-1889",
                "key_works": ["История одного города", "Господа Головлёвы"],
                "works_with_dates": {
                    "История одного города": "1870",
                    "Господа Головлёвы": "1875"
                },
                "about": "Русский писатель-сатирик. Его произведения - едкая критика русского общества и государства. Салтыков-Щедрин использовал фантазию и сатиру для социального анализа."
            },
            "leskov": {
                "name": "Николай Лесков",
                "dates": "1831-1895",
                "key_works": ["Левша", "Очарованный странник"],
                "works_with_dates": {
                    "Левша": "1881",
                    "Очарованный странник": "1873"
                },
                "about": "Русский писатель, мастер рассказа. Лесков писал о русском характере, о чудаках и святых. Его язык богат, полон народного юмора и мудрости."
            },
            
            # REMAINING WRITERS
            "cortazar": {
                "name": "Хулио Кортасар",
                "dates": "1914-1984",
                "key_works": ["Игра в классики", "Конец игры"],
                "works_with_dates": {
                    "Игра в классики": "1963",
                    "Конец игры": "1956"
                },
                "about": "Аргентинский писатель, экспериментатор. 'Игра в классики' - экспериментальный роман, который можно читать в разных порядках. Кортасар исследовал метафикцию и игру со структурой."
            },
            "borges": {
                "name": "Хорхе Луис Борхес",
                "dates": "1899-1986",
                "key_works": ["Фикции", "Вымышленные истории"],
                "works_with_dates": {
                    "Фикции": "1944",
                    "Вымышленные истории": "1935"
                },
                "about": "Аргентинский писатель, создатель микроисторий. Борхес исследовал природу литературы, времени и бесконечности. Его рассказы - философские головоломки."
            },
            "garcia_lorca": {
                "name": "Федерико Гарсиа Лорка",
                "dates": "1898-1936",
                "key_works": ["Кровавая свадьба", "Дом Бернарды Альбы"],
                "works_with_dates": {
                    "Кровавая свадьба": "1933",
                    "Дом Бернарды Альбы": "1936"
                },
                "about": "Испанский поэт и драматург. Лорка писал о страсти, смерти и испанской культуре. Его пьесы - поэтические трагедии о судьбе."
            },
            "cervantes": {
                "name": "Мигель де Сервантес",
                "dates": "1547-1616",
                "key_works": ["Дон Кихот"],
                "works_with_dates": {
                    "Дон Кихот": "1605"
                },
                "about": "Испанский писатель, создатель первого современного романа. 'Дон Кихот' - шедевр о столкновении мечты и реальности."
            },
            "silone": {
                "name": "Игнацио Силоне",
                "dates": "1900-1978",
                "key_works": ["Хлеб и вино"],
                "works_with_dates": {
                    "Хлеб и вино": "1937"
                },
                "about": "Итальянский писатель, антифашист. 'Хлеб и вино' - роман о духовном поиске в фашистской Италии. Силоне писал о вере, революции и человеческом достоинстве."
            },
            "camus": {
                "name": "Альбер Камю",
                "dates": "1913-1960",
                "key_works": ["Посторонний", "Чума"],
                "works_with_dates": {
                    "Посторонний": "1942",
                    "Чума": "1947"
                },
                "about": "Французский писатель-философ. 'Посторонний' - роман об абсурде. 'Чума' - аллегория человеческого состояния. Камю исследовал смысл, смерть и восстание против абсурда."
            },
            "sartre": {
                "name": "Жан-Поль Сартр",
                "dates": "1905-1980",
                "key_works": ["Тошнота", "Бытие и ничто"],
                "works_with_dates": {
                    "Тошнота": "1938",
                    "Бытие и ничто": "1943"
                },
                "about": "Французский философ и писатель. 'Тошнота' - феноменологический роман об отчуждении. Сартр исследовал свободу, ответственность и существование."
            }
        }

    def search_by_name(self, query):
        """Search writers by name in query - handles Russian cases"""
        query_lower = query.lower()
        
        # Russian case variations for common surnames
        russian_variations = {
            'гоголь': ['гоголь', 'гоголе', 'гоголя', 'гоголем', 'гоголю'],
            'толстой': ['толстой', 'толстого', 'толстому'],
            'пушкин': ['пушкин', 'пушкине', 'пушкина', 'пушкину'],
            'достоевский': ['достоевский', 'достоевского', 'достоевскому', 'достоевском'],
            'турgenev': ['тургенев', 'тургенева', 'тургеневу', 'тургеневе'],
            'чехов': ['чехов', 'чехова', 'чехову', 'чехове'],
            'лермонтов': ['лермонтов', 'лермонтова', 'лермонтову', 'лермонтове'],
        }
        
        # Direct search first
        for key, info in self.writers_db.items():
            name_parts = info['name'].lower().split()
            if any(part in query_lower for part in name_parts):
                return key
        
        # Russian case variation search
        for last_name_base, variations in russian_variations.items():
            for var in variations:
                if var in query_lower:
                    # Find the writer with this surname
                    for key, info in self.writers_db.items():
                        if last_name_base in info['name'].lower():
                            return key
        
        return None

    def get_expert_text(self, writer_key, question):
        """Generate expert response with proper formatting"""
        if writer_key not in self.writers_db:
            return "❌ Писатель не найден в базе"
        
        writer = self.writers_db[writer_key]
        name = writer['name']
        dates = writer['dates']
        works_info = writer.get('works_with_dates', {})
        
        # Format works with dates
        works_list = []
        if works_info:
            for work, year in works_info.items():
                works_list.append(f"📚 '{work}' ({year})")
        else:
            for work in writer.get('key_works', []):
                works_list.append(f"📚 {work}")
        
        works_text = "\n".join(works_list) if works_list else "Нет данных о произведениях"
        
        return f"""✨ Давайте погрузимся в мир литературного гения:

📖 **{name}** ({dates})

{writer['about']}

📚 **Главные произведения:**
{works_text}"""

    def get_dialogue_text(self, writer_key, question):
        """Generate dialogue response with proper formatting"""
        if writer_key not in self.writers_db:
            return "❌ Писатель не найден в базе"
        
        writer = self.writers_db[writer_key]
        name = writer['name']
        dates = writer['dates']
        works_info = writer.get('works_with_dates', {})
        
        # Format works with dates
        works_list = []
        if works_info:
            for work, year in works_info.items():
                works_list.append(f"📖 {work} ({year})")
        else:
            for work in writer.get('key_works', []):
                works_list.append(f"📖 {work}")
        
        works_text = ", ".join(works_list) if works_list else "Нет данных"
        
        return f"""💭 Вы общаетесь с **{name}** ({dates})

{writer['about']}

Мои произведения: {works_text}"""


def get_expert_answer(question, writer_key="default"):
    """Get expert response about writer"""
    kb = WritersExpertBase()
    
    if writer_key == "default":
        writer_key = kb.search_by_name(question)
    
    if not writer_key or writer_key not in kb.writers_db:
        return "❌ Писатель не найден"
    
    return kb.get_expert_text(writer_key, question)


def get_dialogue_answer(question, writer_name="default"):
    """Get dialogue response as writer"""
    kb = WritersExpertBase()
    
    if writer_name == "default":
        writer_key = kb.search_by_name(question)
    else:
        # Find by full name
        writer_key = None
        for key, info in kb.writers_db.items():
            if info['name'].lower() in writer_name.lower() or writer_name.lower() in info['name'].lower():
                writer_key = key
                break
    
    if not writer_key or writer_key not in kb.writers_db:
        return "❌ Писатель не найден"
    
    return kb.get_dialogue_text(writer_key, question)


def get_portrait(writer_key):
    """Get writer's self-portrait (description)"""
    kb = WritersExpertBase()
    
    if writer_key not in kb.writers_db:
        return None
    
    writer = kb.writers_db[writer_key]
    return {
        'name': writer.get('name', ''),
        'dates': writer.get('dates', ''),
        'portrait': writer.get('about', ''),
        'key_works': writer.get('key_works', []),
        'works_with_dates': writer.get('works_with_dates', {})
    }


# Initialize knowledge
knowledge = WritersExpertBase()
